import{e as Oe}from"./index-831NsrHV.js";/* empty css                                             */const{SvelteComponent:qe,append:A,attr:T,detach:ue,element:U,flush:M,init:Ie,insert:fe,noop:le,safe_not_equal:Ne,set_data:j,set_style:Y,space:Z,text:q,toggle_class:re}=window.__gradio__svelte__internal,{onMount:Me,createEventDispatcher:je,onDestroy:Je}=window.__gradio__svelte__internal;function se(t){let e,n,i,r,d=I(t[2])+"",a,f,s,o,b=t[2].orig_name+"",_;return{c(){e=U("div"),n=U("span"),i=U("div"),r=U("progress"),a=q(d),s=Z(),o=U("span"),_=q(b),Y(r,"visibility","hidden"),Y(r,"height","0"),Y(r,"width","0"),r.value=f=I(t[2]),T(r,"max","100"),T(r,"class","svelte-1vsfomn"),T(i,"class","progress-bar svelte-1vsfomn"),T(o,"class","file-name svelte-1vsfomn"),T(e,"class","file svelte-1vsfomn")},m(g,h){fe(g,e,h),A(e,n),A(n,i),A(i,r),A(r,a),A(e,s),A(e,o),A(o,_)},p(g,h){h&4&&d!==(d=I(g[2])+"")&&j(a,d),h&4&&f!==(f=I(g[2]))&&(r.value=f),h&4&&b!==(b=g[2].orig_name+"")&&j(_,b)},d(g){g&&ue(e)}}}function Re(t){let e,n,i,r=t[0].length+"",d,a,f=t[0].length>1?"files":"file",s,o,b,_=t[2]&&se(t);return{c(){e=U("div"),n=U("span"),i=q("Uploading "),d=q(r),a=Z(),s=q(f),o=q("..."),b=Z(),_&&_.c(),T(n,"class","uploading svelte-1vsfomn"),T(e,"class","wrap svelte-1vsfomn"),re(e,"progress",t[1])},m(g,h){fe(g,e,h),A(e,n),A(n,i),A(n,d),A(n,a),A(n,s),A(n,o),A(e,b),_&&_.m(e,null)},p(g,[h]){h&1&&r!==(r=g[0].length+"")&&j(d,r),h&1&&f!==(f=g[0].length>1?"files":"file")&&j(s,f),g[2]?_?_.p(g,h):(_=se(g),_.c(),_.m(e,null)):_&&(_.d(1),_=null),h&2&&re(e,"progress",g[1])},i:le,o:le,d(g){g&&ue(e),_&&_.d()}}}function I(t){return t.progress*100/(t.size||0)||0}function Be(t){let e=0;return t.forEach(n=>{e+=I(n)}),document.documentElement.style.setProperty("--upload-progress-width",(e/t.length).toFixed(2)+"%"),e/t.length}function Ge(t,e,n){let{upload_id:i}=e,{root:r}=e,{files:d}=e,{stream_handler:a}=e,f,s=!1,o,b,_=d.map(u=>({...u,progress:0}));const g=je();function h(u,c){n(0,_=_.map(W=>(W.orig_name===u&&(W.progress+=c),W)))}return Me(async()=>{if(f=await a(new URL(`${r}/gradio_api/upload_progress?upload_id=${i}`)),f==null)throw new Error("Event source is not defined");f.onmessage=async function(u){const c=JSON.parse(u.data);s||n(1,s=!0),c.msg==="done"?(f?.close(),g("done")):(n(7,o=c),h(c.orig_name,c.chunk_size))}}),Je(()=>{(f!=null||f!=null)&&f.close()}),t.$$set=u=>{"upload_id"in u&&n(3,i=u.upload_id),"root"in u&&n(4,r=u.root),"files"in u&&n(5,d=u.files),"stream_handler"in u&&n(6,a=u.stream_handler)},t.$$.update=()=>{t.$$.dirty&1&&Be(_),t.$$.dirty&129&&n(2,b=o||_[0])},[_,s,b,i,r,d,a,o]}class He extends qe{constructor(e){super(),Ie(this,e,Ge,Re,Ne,{upload_id:3,root:4,files:5,stream_handler:6})}get upload_id(){return this.$$.ctx[3]}set upload_id(e){this.$$set({upload_id:e}),M()}get root(){return this.$$.ctx[4]}set root(e){this.$$set({root:e}),M()}get files(){return this.$$.ctx[5]}set files(e){this.$$set({files:e}),M()}get stream_handler(){return this.$$.ctx[6]}set stream_handler(e){this.$$set({stream_handler:e}),M()}}const{SvelteComponent:Ke,append:oe,attr:v,binding_callbacks:Qe,bubble:D,check_outros:de,create_component:Ve,create_slot:_e,destroy_component:Xe,detach:R,element:x,empty:he,flush:y,get_all_dirty_from_scope:ge,get_slot_changes:ce,group_outros:me,init:Ye,insert:B,listen:z,mount_component:Ze,prevent_default:P,run_all:xe,safe_not_equal:$e,set_style:J,space:et,stop_propagation:S,toggle_class:p,transition_in:F,transition_out:L,update_slot_base:pe}=window.__gradio__svelte__internal,{createEventDispatcher:tt,tick:it,getContext:dt}=window.__gradio__svelte__internal;function nt(t){let e,n,i,r,d,a,f,s,o,b,_;const g=t[29].default,h=_e(g,t,t[28],null);return{c(){e=x("button"),h&&h.c(),n=et(),i=x("input"),v(i,"aria-label","file upload"),v(i,"data-testid","file-upload"),v(i,"type","file"),v(i,"accept",r=t[18]||void 0),i.multiple=d=t[6]==="multiple"||void 0,v(i,"webkitdirectory",a=t[6]==="directory"||void 0),v(i,"mozdirectory",f=t[6]==="directory"||void 0),v(i,"class","svelte-1b742ao"),v(e,"tabindex",s=t[9]?-1:0),v(e,"class","svelte-1b742ao"),p(e,"hidden",t[9]),p(e,"center",t[4]),p(e,"boundedheight",t[3]),p(e,"flex",t[5]),p(e,"disable_click",t[7]),p(e,"icon-mode",t[12]),J(e,"height",t[12]?"":t[13]?typeof t[13]=="number"?t[13]+"px":t[13]:"100%")},m(u,c){B(u,e,c),h&&h.m(e,null),oe(e,n),oe(e,i),t[37](i),o=!0,b||(_=[z(i,"change",t[20]),z(e,"drag",S(P(t[30]))),z(e,"dragstart",S(P(t[31]))),z(e,"dragend",S(P(t[32]))),z(e,"dragover",S(P(t[33]))),z(e,"dragenter",S(P(t[34]))),z(e,"dragleave",S(P(t[35]))),z(e,"drop",S(P(t[36]))),z(e,"click",t[15]),z(e,"drop",t[21]),z(e,"dragenter",t[19]),z(e,"dragleave",t[19])],b=!0)},p(u,c){h&&h.p&&(!o||c[0]&268435456)&&pe(h,g,u,u[28],o?ce(g,u[28],c,null):ge(u[28]),null),(!o||c[0]&262144&&r!==(r=u[18]||void 0))&&v(i,"accept",r),(!o||c[0]&64&&d!==(d=u[6]==="multiple"||void 0))&&(i.multiple=d),(!o||c[0]&64&&a!==(a=u[6]==="directory"||void 0))&&v(i,"webkitdirectory",a),(!o||c[0]&64&&f!==(f=u[6]==="directory"||void 0))&&v(i,"mozdirectory",f),(!o||c[0]&512&&s!==(s=u[9]?-1:0))&&v(e,"tabindex",s),(!o||c[0]&512)&&p(e,"hidden",u[9]),(!o||c[0]&16)&&p(e,"center",u[4]),(!o||c[0]&8)&&p(e,"boundedheight",u[3]),(!o||c[0]&32)&&p(e,"flex",u[5]),(!o||c[0]&128)&&p(e,"disable_click",u[7]),(!o||c[0]&4096)&&p(e,"icon-mode",u[12]),c[0]&12288&&J(e,"height",u[12]?"":u[13]?typeof u[13]=="number"?u[13]+"px":u[13]:"100%")},i(u){o||(F(h,u),o=!0)},o(u){L(h,u),o=!1},d(u){u&&R(e),h&&h.d(u),t[37](null),b=!1,xe(_)}}}function lt(t){let e,n,i=!t[9]&&ae(t);return{c(){i&&i.c(),e=he()},m(r,d){i&&i.m(r,d),B(r,e,d),n=!0},p(r,d){r[9]?i&&(me(),L(i,1,1,()=>{i=null}),de()):i?(i.p(r,d),d[0]&512&&F(i,1)):(i=ae(r),i.c(),F(i,1),i.m(e.parentNode,e))},i(r){n||(F(i),n=!0)},o(r){L(i),n=!1},d(r){r&&R(e),i&&i.d(r)}}}function rt(t){let e,n,i,r,d;const a=t[29].default,f=_e(a,t,t[28],null);return{c(){e=x("button"),f&&f.c(),v(e,"tabindex",n=t[9]?-1:0),v(e,"class","svelte-1b742ao"),p(e,"hidden",t[9]),p(e,"center",t[4]),p(e,"boundedheight",t[3]),p(e,"flex",t[5]),p(e,"icon-mode",t[12]),J(e,"height",t[12]?"":t[13]?typeof t[13]=="number"?t[13]+"px":t[13]:"100%")},m(s,o){B(s,e,o),f&&f.m(e,null),i=!0,r||(d=z(e,"click",t[14]),r=!0)},p(s,o){f&&f.p&&(!i||o[0]&268435456)&&pe(f,a,s,s[28],i?ce(a,s[28],o,null):ge(s[28]),null),(!i||o[0]&512&&n!==(n=s[9]?-1:0))&&v(e,"tabindex",n),(!i||o[0]&512)&&p(e,"hidden",s[9]),(!i||o[0]&16)&&p(e,"center",s[4]),(!i||o[0]&8)&&p(e,"boundedheight",s[3]),(!i||o[0]&32)&&p(e,"flex",s[5]),(!i||o[0]&4096)&&p(e,"icon-mode",s[12]),o[0]&12288&&J(e,"height",s[12]?"":s[13]?typeof s[13]=="number"?s[13]+"px":s[13]:"100%")},i(s){i||(F(f,s),i=!0)},o(s){L(f,s),i=!1},d(s){s&&R(e),f&&f.d(s),r=!1,d()}}}function ae(t){let e,n;return e=new He({props:{root:t[8],upload_id:t[16],files:t[17],stream_handler:t[11]}}),{c(){Ve(e.$$.fragment)},m(i,r){Ze(e,i,r),n=!0},p(i,r){const d={};r[0]&256&&(d.root=i[8]),r[0]&65536&&(d.upload_id=i[16]),r[0]&131072&&(d.files=i[17]),r[0]&2048&&(d.stream_handler=i[11]),e.$set(d)},i(i){n||(F(e.$$.fragment,i),n=!0)},o(i){L(e.$$.fragment,i),n=!1},d(i){Xe(e,i)}}}function st(t){let e,n,i,r;const d=[rt,lt,nt],a=[];function f(s,o){return s[0]==="clipboard"?0:s[1]&&s[10]?1:2}return e=f(t),n=a[e]=d[e](t),{c(){n.c(),i=he()},m(s,o){a[e].m(s,o),B(s,i,o),r=!0},p(s,o){let b=e;e=f(s),e===b?a[e].p(s,o):(me(),L(a[b],1,1,()=>{a[b]=null}),de(),n=a[e],n?n.p(s,o):(n=a[e]=d[e](s),n.c()),F(n,1),n.m(i.parentNode,i))},i(s){r||(F(n),r=!0)},o(s){L(n),r=!1},d(s){s&&R(i),a[e].d(s)}}}function ot(t,e,n){if(!t||t==="*"||t==="file/*"||Array.isArray(t)&&t.some(r=>r==="*"||r==="file/*"))return!0;let i;if(typeof t=="string")i=t.split(",").map(r=>r.trim());else if(Array.isArray(t))i=t;else return!1;return i.includes(e)||i.some(r=>{const[d]=r.split("/").map(a=>a.trim());return r.endsWith("/*")&&n.startsWith(d+"/")})}function at(t,e,n){let i,{$$slots:r={},$$scope:d}=e,{filetype:a=null}=e,{dragging:f=!1}=e,{boundedheight:s=!0}=e,{center:o=!0}=e,{flex:b=!0}=e,{file_count:_="single"}=e,{disable_click:g=!1}=e,{root:h}=e,{hidden:u=!1}=e,{format:c="file"}=e,{uploading:W=!1}=e,{hidden_upload:C=null}=e,{show_progress:$=!0}=e,{max_file_size:G=null}=e,{upload:H}=e,{stream_handler:ee}=e,{icon_upload:te=!1}=e,{height:ie=void 0}=e,K,Q,O,ne=null;const be=()=>{if(typeof navigator<"u"){const l=navigator.userAgent.toLowerCase();return l.indexOf("iphone")>-1||l.indexOf("ipad")>-1}return!1},E=tt(),ye=["image","video","audio","text","file"],V=l=>i&&l.startsWith(".")?(ne=!0,l):i&&l.includes("file/*")?"*":l.startsWith(".")||l.endsWith("/*")?l:ye.includes(l)?l+"/*":"."+l;function we(){n(22,f=!f)}function ke(){navigator.clipboard.read().then(async l=>{for(let m=0;m<l.length;m++){const w=l[m].types.find(k=>k.startsWith("image/"));if(w){l[m].getType(w).then(async k=>{const X=new File([k],`clipboard.${w.replace("image/","")}`);await N([X])});break}}})}function ve(){g||C&&(n(2,C.value="",C),C.click())}async function Ae(l){await it(),n(16,K=Math.random().toString(36).substring(2,15)),n(1,W=!0);try{const m=await H(l,h,K,G??1/0);return E("load",_==="single"?m?.[0]:m),n(1,W=!1),m||[]}catch(m){return E("error",m.message),n(1,W=!1),[]}}async function N(l){if(!l.length)return;let m=l.map(w=>new File([w],w instanceof File?w.name:"file",{type:w.type}));return i&&ne&&(m=m.filter(w=>ze(w)?!0:(E("error",`Invalid file type: ${w.name}. Only ${a} allowed.`),!1)),m.length===0)?[]:(n(17,Q=await Oe(m)),await Ae(Q))}function ze(l){return a?(Array.isArray(a)?a:[a]).some(w=>{const k=V(w);if(k.startsWith("."))return l.name.toLowerCase().endsWith(k.toLowerCase());if(k==="*")return!0;if(k.endsWith("/*")){const[X]=k.split("/");return l.type.startsWith(X+"/")}return l.type===k}):!0}async function We(l){const m=l.target;if(m.files)if(c!="blob")await N(Array.from(m.files));else{if(_==="single"){E("load",m.files[0]);return}E("load",m.files)}}async function Ce(l){if(n(22,f=!1),!l.dataTransfer?.files)return;const m=Array.from(l.dataTransfer.files).filter(w=>{const k="."+w.name.split(".").pop();return k&&ot(O,k,w.type)||(k&&Array.isArray(a)?a.includes(k):k===a)?!0:(E("error",`Invalid file type only ${a} allowed.`),!1)});if(c!="blob")await N(m);else{if(_==="single"){E("load",m[0]);return}E("load",m)}}function Ee(l){D.call(this,t,l)}function Fe(l){D.call(this,t,l)}function De(l){D.call(this,t,l)}function Pe(l){D.call(this,t,l)}function Se(l){D.call(this,t,l)}function Te(l){D.call(this,t,l)}function Ue(l){D.call(this,t,l)}function Le(l){Qe[l?"unshift":"push"](()=>{C=l,n(2,C)})}return t.$$set=l=>{"filetype"in l&&n(0,a=l.filetype),"dragging"in l&&n(22,f=l.dragging),"boundedheight"in l&&n(3,s=l.boundedheight),"center"in l&&n(4,o=l.center),"flex"in l&&n(5,b=l.flex),"file_count"in l&&n(6,_=l.file_count),"disable_click"in l&&n(7,g=l.disable_click),"root"in l&&n(8,h=l.root),"hidden"in l&&n(9,u=l.hidden),"format"in l&&n(23,c=l.format),"uploading"in l&&n(1,W=l.uploading),"hidden_upload"in l&&n(2,C=l.hidden_upload),"show_progress"in l&&n(10,$=l.show_progress),"max_file_size"in l&&n(24,G=l.max_file_size),"upload"in l&&n(25,H=l.upload),"stream_handler"in l&&n(11,ee=l.stream_handler),"icon_upload"in l&&n(12,te=l.icon_upload),"height"in l&&n(13,ie=l.height),"$$scope"in l&&n(28,d=l.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&134217729&&(a==null?n(18,O=null):typeof a=="string"?n(18,O=V(a)):i&&a.includes("file/*")?n(18,O="*"):(n(0,a=a.map(V)),n(18,O=a.join(", "))))},n(27,i=be()),[a,W,C,s,o,b,_,g,h,u,$,ee,te,ie,ke,ve,K,Q,O,we,We,Ce,f,c,G,H,N,i,d,r,Ee,Fe,De,Pe,Se,Te,Ue,Le]}class _t extends Ke{constructor(e){super(),Ye(this,e,at,st,$e,{filetype:0,dragging:22,boundedheight:3,center:4,flex:5,file_count:6,disable_click:7,root:8,hidden:9,format:23,uploading:1,hidden_upload:2,show_progress:10,max_file_size:24,upload:25,stream_handler:11,icon_upload:12,height:13,paste_clipboard:14,open_file_upload:15,load_files:26},null,[-1,-1])}get filetype(){return this.$$.ctx[0]}set filetype(e){this.$$set({filetype:e}),y()}get dragging(){return this.$$.ctx[22]}set dragging(e){this.$$set({dragging:e}),y()}get boundedheight(){return this.$$.ctx[3]}set boundedheight(e){this.$$set({boundedheight:e}),y()}get center(){return this.$$.ctx[4]}set center(e){this.$$set({center:e}),y()}get flex(){return this.$$.ctx[5]}set flex(e){this.$$set({flex:e}),y()}get file_count(){return this.$$.ctx[6]}set file_count(e){this.$$set({file_count:e}),y()}get disable_click(){return this.$$.ctx[7]}set disable_click(e){this.$$set({disable_click:e}),y()}get root(){return this.$$.ctx[8]}set root(e){this.$$set({root:e}),y()}get hidden(){return this.$$.ctx[9]}set hidden(e){this.$$set({hidden:e}),y()}get format(){return this.$$.ctx[23]}set format(e){this.$$set({format:e}),y()}get uploading(){return this.$$.ctx[1]}set uploading(e){this.$$set({uploading:e}),y()}get hidden_upload(){return this.$$.ctx[2]}set hidden_upload(e){this.$$set({hidden_upload:e}),y()}get show_progress(){return this.$$.ctx[10]}set show_progress(e){this.$$set({show_progress:e}),y()}get max_file_size(){return this.$$.ctx[24]}set max_file_size(e){this.$$set({max_file_size:e}),y()}get upload(){return this.$$.ctx[25]}set upload(e){this.$$set({upload:e}),y()}get stream_handler(){return this.$$.ctx[11]}set stream_handler(e){this.$$set({stream_handler:e}),y()}get icon_upload(){return this.$$.ctx[12]}set icon_upload(e){this.$$set({icon_upload:e}),y()}get height(){return this.$$.ctx[13]}set height(e){this.$$set({height:e}),y()}get paste_clipboard(){return this.$$.ctx[14]}get open_file_upload(){return this.$$.ctx[15]}get load_files(){return this.$$.ctx[26]}}export{_t as U};
//# sourceMappingURL=Upload-C-wr1ITR.js.map
