import{a as fe,i as _e,s as me,E as ae,z as m,d as B,C as D,D as Q,l as C,y as R,c as q,b as A,w as ie,$ as oe,m as N,H as te,k as b,t as k,n as T,o as Me,f as I,A as G,ar as Be,h as X,j as Y,a5 as Pe,aa as Je,K as $,e as de,M as Ke,N as Ve,ay as Ge,P as Qe,R as Xe,ax as Ye,aq as Ce,as as Ze,O as We,x as ge,a7 as ce,a8 as ue,J as $e,p as he,I as xe,a2 as et,q as tt,u as it,r as lt,v as nt}from"../lite.js";import{B as rt}from"./BlockLabel-DWW9BWN3.js";import{I as st,F as at}from"./FullscreenButton-DsVuMC2h.js";import{W as ot,a as ct,S as ut}from"./SelectSource-X14PCdzX.js";import{I as ft}from"./IconButtonWrapper-BQG8MTSb.js";import{g as _t}from"./utils-Gtzs_Zla.js";import{D as Ae}from"./DropdownArrow-DIboSv6l.js";import{S as mt}from"./Square-CkbFMpLj.js";import{f as dt}from"./index-B9I6rkKj.js";import{S as gt}from"./StreamingBar-lVbwTGD1.js";import{U as ht}from"./Upload-CHvl3E40.js";import{I as bt}from"./Image-DewrJLf7.js";function wt(n){let e,t,i;return{c(){e=ae("svg"),t=ae("path"),i=ae("circle"),m(t,"d","M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"),m(i,"cx","12"),m(i,"cy","13"),m(i,"r","4"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"width","100%"),m(e,"height","100%"),m(e,"viewBox","0 0 24 24"),m(e,"fill","none"),m(e,"stroke","currentColor"),m(e,"stroke-width","1.5"),m(e,"stroke-linecap","round"),m(e,"stroke-linejoin","round"),m(e,"class","feather feather-camera")},m(l,s){B(l,e,s),D(e,t),D(e,i)},p:Q,i:Q,o:Q,d(l){l&&C(e)}}}class pt extends fe{constructor(e){super(),_e(this,e,null,wt,me,{})}}function vt(n){let e,t;return{c(){e=ae("svg"),t=ae("circle"),m(t,"cx","12"),m(t,"cy","12"),m(t,"r","10"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"width","100%"),m(e,"height","100%"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width","1.5"),m(e,"stroke-linecap","round"),m(e,"stroke-linejoin","round"),m(e,"class","feather feather-circle")},m(i,l){B(i,e,l),D(e,t)},p:Q,i:Q,o:Q,d(i){i&&C(e)}}}class kt extends fe{constructor(e){super(),_e(this,e,null,vt,me,{})}}function yt(n){let e,t,i,l,s,r="Click to Access Webcam",c,a,u,_;return l=new ot({}),{c(){e=R("button"),t=R("div"),i=R("span"),q(l.$$.fragment),s=A(),c=ie(r),m(i,"class","icon-wrap svelte-qbrfs"),m(t,"class","wrap svelte-qbrfs"),m(e,"class","svelte-qbrfs"),oe(e,"height","100%")},m(f,y){B(f,e,y),D(e,t),D(t,i),N(l,i,null),D(t,s),D(t,c),a=!0,u||(_=te(e,"click",n[1]),u=!0)},p:Q,i(f){a||(b(l.$$.fragment,f),a=!0)},o(f){k(l.$$.fragment,f),a=!1},d(f){f&&C(e),T(l),u=!1,_()}}}function It(n){const e=Me();return[e,()=>e("click")]}class Dt extends fe{constructor(e){super(),_e(this,e,It,yt,me,{})}}function Wt(){return navigator.mediaDevices.enumerateDevices()}function Mt(n,e){e.srcObject=n,e.muted=!0,e.play()}async function Re(n,e,t,i){const l={video:i?{deviceId:{exact:i},...t?.video}:t?.video||{width:{ideal:1920},height:{ideal:1440}},audio:n&&(t?.audio??!0)};return navigator.mediaDevices.getUserMedia(l).then(s=>(Mt(s,e),s))}function zt(n){return n.filter(t=>t.kind==="videoinput")}function Se(n,e,t){const i=n.slice();return i[39]=e[t],i}function Bt(n){let e,t,i,l,s,r,c,a,u,_,f;const y=[St,Rt],z=[];function U(p,M){return p[2]==="video"||p[1]?0:1}i=U(n),l=z[i]=y[i](n);let h=!n[11]&&Ee(n),w=n[13]&&n[8]&&je(n);return{c(){e=R("div"),t=R("button"),l.c(),r=A(),h&&h.c(),c=A(),w&&w.c(),a=de(),m(t,"aria-label",s=n[2]==="image"?"capture photo":"start recording"),m(t,"class","svelte-s8feoe"),m(e,"class","button-wrap svelte-s8feoe")},m(p,M){B(p,e,M),D(e,t),z[i].m(t,null),D(e,r),h&&h.m(e,null),B(p,c,M),w&&w.m(p,M),B(p,a,M),u=!0,_||(f=te(t,"click",n[28]),_=!0)},p(p,M){let F=i;i=U(p),i===F?z[i].p(p,M):(X(),k(z[F],1,1,()=>{z[F]=null}),Y(),l=z[i],l?l.p(p,M):(l=z[i]=y[i](p),l.c()),b(l,1),l.m(t,null)),(!u||M[0]&4&&s!==(s=p[2]==="image"?"capture photo":"start recording"))&&m(t,"aria-label",s),p[11]?h&&(X(),k(h,1,1,()=>{h=null}),Y()):h?(h.p(p,M),M[0]&2048&&b(h,1)):(h=Ee(p),h.c(),b(h,1),h.m(e,null)),p[13]&&p[8]?w?(w.p(p,M),M[0]&8448&&b(w,1)):(w=je(p),w.c(),b(w,1),w.m(a.parentNode,a)):w&&(X(),k(w,1,1,()=>{w=null}),Y())},i(p){u||(b(l),b(h),b(w),u=!0)},o(p){k(l),k(h),k(w),u=!1},d(p){p&&(C(e),C(c),C(a)),z[i].d(),h&&h.d(),w&&w.d(p),_=!1,f()}}}function Ct(n){let e,t,i,l;return t=new Dt({}),t.$on("click",n[27]),{c(){e=R("div"),q(t.$$.fragment),m(e,"title","grant webcam access"),oe(e,"height","100%")},m(s,r){B(s,e,r),N(t,e,null),l=!0},p:Q,i(s){l||(b(t.$$.fragment,s),s&&(i||Ke(()=>{i=Ve(e,dt,{delay:100,duration:200}),i.start()})),l=!0)},o(s){k(t.$$.fragment,s),l=!1},d(s){s&&C(e),T(t)}}}function Rt(n){let e,t,i;return t=new pt({}),{c(){e=R("div"),q(t.$$.fragment),m(e,"class","icon svelte-s8feoe"),m(e,"title","capture photo")},m(l,s){B(l,e,s),N(t,e,null),i=!0},p:Q,i(l){i||(b(t.$$.fragment,l),i=!0)},o(l){k(t.$$.fragment,l),i=!1},d(l){l&&C(e),T(t)}}}function St(n){let e,t,i,l;const s=[qt,jt,Et],r=[];function c(a,u){return a[1]&&a[10]==="waiting"?0:a[1]&&a[10]==="open"||!a[1]&&a[11]?1:2}return e=c(n),t=r[e]=s[e](n),{c(){t.c(),i=de()},m(a,u){r[e].m(a,u),B(a,i,u),l=!0},p(a,u){let _=e;e=c(a),e===_?r[e].p(a,u):(X(),k(r[_],1,1,()=>{r[_]=null}),Y(),t=r[e],t?t.p(a,u):(t=r[e]=s[e](a),t.c()),b(t,1),t.m(i.parentNode,i))},i(a){l||(b(t),l=!0)},o(a){k(t),l=!1},d(a){a&&C(i),r[e].d(a)}}}function Et(n){let e,t,i,l,s=n[4]("audio.record")+"",r,c;return i=new kt({}),{c(){e=R("div"),t=R("div"),q(i.$$.fragment),l=A(),r=ie(s),m(t,"class","icon color-primary svelte-s8feoe"),m(t,"title","start recording"),m(e,"class","icon-with-text svelte-s8feoe")},m(a,u){B(a,e,u),D(e,t),N(i,t,null),D(e,l),D(e,r),c=!0},p(a,u){(!c||u[0]&16)&&s!==(s=a[4]("audio.record")+"")&&ge(r,s)},i(a){c||(b(i.$$.fragment,a),c=!0)},o(a){k(i.$$.fragment,a),c=!1},d(a){a&&C(e),T(i)}}}function jt(n){let e,t,i,l,s=n[4]("audio.stop")+"",r,c;return i=new mt({}),{c(){e=R("div"),t=R("div"),q(i.$$.fragment),l=A(),r=ie(s),m(t,"class","icon color-primary svelte-s8feoe"),m(t,"title","stop recording"),m(e,"class","icon-with-text svelte-s8feoe")},m(a,u){B(a,e,u),D(e,t),N(i,t,null),D(e,l),D(e,r),c=!0},p(a,u){(!c||u[0]&16)&&s!==(s=a[4]("audio.stop")+"")&&ge(r,s)},i(a){c||(b(i.$$.fragment,a),c=!0)},o(a){k(i.$$.fragment,a),c=!1},d(a){a&&C(e),T(i)}}}function qt(n){let e,t,i,l,s=n[4]("audio.waiting")+"",r,c;return i=new ct({}),{c(){e=R("div"),t=R("div"),q(i.$$.fragment),l=A(),r=ie(s),m(t,"class","icon color-primary svelte-s8feoe"),m(t,"title","spinner"),m(e,"class","icon-with-text svelte-s8feoe"),oe(e,"width","var(--size-24)")},m(a,u){B(a,e,u),D(e,t),N(i,t,null),D(e,l),D(e,r),c=!0},p(a,u){(!c||u[0]&16)&&s!==(s=a[4]("audio.waiting")+"")&&ge(r,s)},i(a){c||(b(i.$$.fragment,a),c=!0)},o(a){k(i.$$.fragment,a),c=!1},d(a){a&&C(e),T(i)}}}function Ee(n){let e,t,i,l,s;return t=new Ae({}),{c(){e=R("button"),q(t.$$.fragment),m(e,"class","icon svelte-s8feoe"),m(e,"aria-label","select input source")},m(r,c){B(r,e,c),N(t,e,null),i=!0,l||(s=te(e,"click",n[29]),l=!0)},p:Q,i(r){i||(b(t.$$.fragment,r),i=!0)},o(r){k(t.$$.fragment,r),i=!1},d(r){r&&C(e),T(t),l=!1,s()}}}function je(n){let e,t,i,l,s,r,c;i=new Ae({});function a(f,y){return f[7].length===0?Tt:Nt}let u=a(n),_=u(n);return{c(){e=R("select"),t=R("button"),q(i.$$.fragment),l=A(),_.c(),m(t,"class","inset-icon svelte-s8feoe"),m(e,"class","select-wrap svelte-s8feoe"),m(e,"aria-label","select source")},m(f,y){B(f,e,y),D(e,t),N(i,t,null),D(t,l),_.m(e,null),s=!0,r||(c=[te(t,"click",Ge(n[30])),Qe(ze.call(null,e,n[17])),te(e,"change",n[14])],r=!0)},p(f,y){u===(u=a(f))&&_?_.p(f,y):(_.d(1),_=u(f),_&&(_.c(),_.m(e,null)))},i(f){s||(b(i.$$.fragment,f),s=!0)},o(f){k(i.$$.fragment,f),s=!1},d(f){f&&C(e),T(i),_.d(),r=!1,Xe(c)}}}function Nt(n){let e,t=Ce(n[7]),i=[];for(let l=0;l<t.length;l+=1)i[l]=qe(Se(n,t,l));return{c(){for(let l=0;l<i.length;l+=1)i[l].c();e=de()},m(l,s){for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(l,s);B(l,e,s)},p(l,s){if(s[0]&384){t=Ce(l[7]);let r;for(r=0;r<t.length;r+=1){const c=Se(l,t,r);i[r]?i[r].p(c,s):(i[r]=qe(c),i[r].c(),i[r].m(e.parentNode,e))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},d(l){l&&C(e),Ze(i,l)}}}function Tt(n){let e,t=n[4]("common.no_devices")+"",i;return{c(){e=R("option"),i=ie(t),e.__value="",We(e,e.__value),m(e,"class","svelte-s8feoe")},m(l,s){B(l,e,s),D(e,i)},p(l,s){s[0]&16&&t!==(t=l[4]("common.no_devices")+"")&&ge(i,t)},d(l){l&&C(e)}}}function qe(n){let e,t=n[39].label+"",i,l,s,r;return{c(){e=R("option"),i=ie(t),l=A(),e.__value=s=n[39].deviceId,We(e,e.__value),e.selected=r=n[8].deviceId===n[39].deviceId,m(e,"class","svelte-s8feoe")},m(c,a){B(c,e,a),D(e,i),D(e,l)},p(c,a){a[0]&128&&t!==(t=c[39].label+"")&&ge(i,t),a[0]&128&&s!==(s=c[39].deviceId)&&(e.__value=s,We(e,e.__value)),a[0]&384&&r!==(r=c[8].deviceId===c[39].deviceId)&&(e.selected=r)},d(c){c&&C(e)}}}function Ut(n){let e,t,i,l,s,r,c,a,u,_,f;t=new gt({props:{time_limit:n[9]}});const y=[Ct,Bt],z=[];function U(h,w){return h[12]?1:0}return u=U(n),_=z[u]=y[u](n),{c(){e=R("div"),q(t.$$.fragment),i=A(),l=R("video"),s=A(),r=R("img"),a=A(),_.c(),m(l,"class","svelte-s8feoe"),G(l,"flip",n[3]),G(l,"hide",!n[12]||n[12]&&!!n[0]),Be(r.src,c=n[0]?.url)||m(r,"src",c),m(r,"class","svelte-s8feoe"),G(r,"hide",!n[12]||n[12]&&!n[0]),m(e,"class","wrap svelte-s8feoe")},m(h,w){B(h,e,w),N(t,e,null),D(e,i),D(e,l),n[26](l),D(e,s),D(e,r),D(e,a),z[u].m(e,null),f=!0},p(h,w){const p={};w[0]&512&&(p.time_limit=h[9]),t.$set(p),(!f||w[0]&8)&&G(l,"flip",h[3]),(!f||w[0]&4097)&&G(l,"hide",!h[12]||h[12]&&!!h[0]),(!f||w[0]&1&&!Be(r.src,c=h[0]?.url))&&m(r,"src",c),(!f||w[0]&4097)&&G(r,"hide",!h[12]||h[12]&&!h[0]);let M=u;u=U(h),u===M?z[u].p(h,w):(X(),k(z[M],1,1,()=>{z[M]=null}),Y(),_=z[u],_?_.p(h,w):(_=z[u]=y[u](h),_.c()),b(_,1),_.m(e,null))},i(h){f||(b(t.$$.fragment,h),b(_),f=!0)},o(h){k(t.$$.fragment,h),k(_),f=!1},d(h){h&&C(e),T(t),n[26](null),z[u].d()}}}function ze(n,e){const t=i=>{n&&!n.contains(i.target)&&!i.defaultPrevented&&e(i)};return document.addEventListener("click",t,!0),{destroy(){document.removeEventListener("click",t,!0)}}}function Lt(n,e,t){let i,l=[],s=null,r=null,c="closed";const a=g=>{g==="closed"?(t(9,r=null),t(10,c="closed"),t(0,P=null)):g==="waiting"?t(10,c="waiting"):t(10,c="open")},u=g=>{L&&t(9,r=g)};let _,{streaming:f=!1}=e,{pending:y=!1}=e,{root:z=""}=e,{stream_every:U=1}=e,{mode:h="image"}=e,{mirror_webcam:w}=e,{include_audio:p}=e,{webcam_constraints:M=null}=e,{i18n:F}=e,{upload:E}=e,{value:P=null}=e;const W=Me();Pe(()=>{_=document.createElement("canvas"),f&&h==="image"&&window.setInterval(()=>{i&&!y&&H()},U*1e3)});const d=async g=>{const V=g.target.value;await Re(p,i,M,V).then(async re=>{J=re,t(8,s=l.find(se=>se.deviceId===V)||null),t(13,Z=!1)})};async function v(){try{Re(p,i,M).then(async g=>{t(12,le=!0),t(7,l=await Wt()),J=g}).then(()=>zt(l)).then(g=>{t(7,l=g);const S=J.getTracks().map(V=>V.getSettings()?.deviceId)[0];t(8,s=S&&g.find(V=>V.deviceId===S)||l[0])}),(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)&&W("error",F("image.no_webcam_support"))}catch(g){if(g instanceof DOMException&&g.name=="NotAllowedError")W("error",F("image.allow_webcam_access"));else throw g}}function H(){var g=_.getContext("2d");if((!f||f&&L)&&i.videoWidth&&i.videoHeight){if(_.width=i.videoWidth,_.height=i.videoHeight,g.drawImage(i,0,0,i.videoWidth,i.videoHeight),w&&(g.scale(-1,1),g.drawImage(i,-i.videoWidth,0)),f&&(!L||c==="waiting"))return;if(f){const S=_.toDataURL("image/jpeg");W("stream",S);return}_.toBlob(S=>{W(f?"stream":"capture",S)},`image/${f?"jpeg":"png"}`,.8)}}let L=!1,j=[],J,K,O;function x(){if(L){O.stop();let g=new Blob(j,{type:K}),S=new FileReader;S.onload=async function(V){if(V.target){let re=new File([g],"sample."+K.substring(6));const se=await Ye([re]);let Ie=(await E(se,z))?.filter(Boolean)[0];W("capture",Ie),W("stop_recording")}},S.readAsDataURL(g)}else if(typeof MediaRecorder<"u"){W("start_recording"),j=[];let g=["video/webm","video/mp4"];for(let S of g)if(MediaRecorder.isTypeSupported(S)){K=S;break}if(K===null){console.error("No supported MediaRecorder mimeType");return}O=new MediaRecorder(J,{mimeType:K}),O.addEventListener("dataavailable",function(S){j.push(S.data)}),O.start(200)}t(11,L=!L)}let le=!1;function ne({destroy:g}={}){h==="image"&&f&&t(11,L=!L),g||(h==="image"?H():x()),!L&&J&&(W("close_stream"),J.getTracks().forEach(S=>S.stop()),t(6,i.srcObject=null,i),t(12,le=!1),window.setTimeout(()=>{t(0,P=null)},500),t(0,P=null))}let Z=!1;function be(g){g.preventDefault(),g.stopPropagation(),t(13,Z=!1)}Je(()=>{typeof window>"u"||(ne({destroy:!0}),J?.getTracks().forEach(g=>g.stop()))});function we(g){$[g?"unshift":"push"](()=>{i=g,t(6,i)})}const pe=async()=>v(),ve=()=>ne(),ke=()=>t(13,Z=!0),ye=()=>t(13,Z=!1);return n.$$set=g=>{"streaming"in g&&t(1,f=g.streaming),"pending"in g&&t(20,y=g.pending),"root"in g&&t(21,z=g.root),"stream_every"in g&&t(22,U=g.stream_every),"mode"in g&&t(2,h=g.mode),"mirror_webcam"in g&&t(3,w=g.mirror_webcam),"include_audio"in g&&t(23,p=g.include_audio),"webcam_constraints"in g&&t(24,M=g.webcam_constraints),"i18n"in g&&t(4,F=g.i18n),"upload"in g&&t(25,E=g.upload),"value"in g&&t(0,P=g.value)},[P,f,h,w,F,ze,i,l,s,r,c,L,le,Z,d,v,ne,be,a,u,y,z,U,p,M,E,we,pe,ve,ke,ye]}class At extends fe{constructor(e){super(),_e(this,e,Lt,Ut,me,{modify_stream:18,set_time_limit:19,streaming:1,pending:20,root:21,stream_every:22,mode:2,mirror_webcam:3,include_audio:23,webcam_constraints:24,i18n:4,upload:25,value:0,click_outside:5},null,[-1,-1])}get modify_stream(){return this.$$.ctx[18]}get set_time_limit(){return this.$$.ctx[19]}get streaming(){return this.$$.ctx[1]}set streaming(e){this.$$set({streaming:e}),I()}get pending(){return this.$$.ctx[20]}set pending(e){this.$$set({pending:e}),I()}get root(){return this.$$.ctx[21]}set root(e){this.$$set({root:e}),I()}get stream_every(){return this.$$.ctx[22]}set stream_every(e){this.$$set({stream_every:e}),I()}get mode(){return this.$$.ctx[2]}set mode(e){this.$$set({mode:e}),I()}get mirror_webcam(){return this.$$.ctx[3]}set mirror_webcam(e){this.$$set({mirror_webcam:e}),I()}get include_audio(){return this.$$.ctx[23]}set include_audio(e){this.$$set({include_audio:e}),I()}get webcam_constraints(){return this.$$.ctx[24]}set webcam_constraints(e){this.$$set({webcam_constraints:e}),I()}get i18n(){return this.$$.ctx[4]}set i18n(e){this.$$set({i18n:e}),I()}get upload(){return this.$$.ctx[25]}set upload(e){this.$$set({upload:e}),I()}get value(){return this.$$.ctx[0]}set value(e){this.$$set({value:e}),I()}get click_outside(){return ze}}const Ft=At;function Ne(n){let e,t,i,l=n[18]&&Te(n);return t=new xe({props:{Icon:et,label:"Remove Image"}}),t.$on("click",n[31]),{c(){l&&l.c(),e=A(),q(t.$$.fragment)},m(s,r){l&&l.m(s,r),B(s,e,r),N(t,s,r),i=!0},p(s,r){s[18]?l?(l.p(s,r),r[0]&262144&&b(l,1)):(l=Te(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(X(),k(l,1,1,()=>{l=null}),Y())},i(s){i||(b(l),b(t.$$.fragment,s),i=!0)},o(s){k(l),k(t.$$.fragment,s),i=!1},d(s){s&&C(e),l&&l.d(s),T(t,s)}}}function Te(n){let e,t;return e=new at({props:{container:n[22]}}),{c(){q(e.$$.fragment)},m(i,l){N(e,i,l),t=!0},p(i,l){const s={};l[0]&4194304&&(s.container=i[22]),e.$set(s)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){k(e.$$.fragment,i),t=!1},d(i){T(e,i)}}}function Ht(n){let e,t,i=n[3]?.url&&!n[20]&&Ne(n);return{c(){i&&i.c(),e=de()},m(l,s){i&&i.m(l,s),B(l,e,s),t=!0},p(l,s){l[3]?.url&&!l[20]?i?(i.p(l,s),s[0]&1048584&&b(i,1)):(i=Ne(l),i.c(),b(i,1),i.m(e.parentNode,e)):i&&(X(),k(i,1,1,()=>{i=null}),Y())},i(l){t||(b(i),t=!0)},o(l){k(i),t=!1},d(l){l&&C(e),i&&i.d(l)}}}function Ue(n){let e;const t=n[30].default,i=tt(t,n,n[46],null);return{c(){i&&i.c()},m(l,s){i&&i.m(l,s),e=!0},p(l,s){i&&i.p&&(!e||s[1]&32768)&&it(i,t,l,l[46],e?nt(t,l[46],s,null):lt(l[46]),null)},i(l){e||(b(i,l),e=!0)},o(l){k(i,l),e=!1},d(l){i&&i.d(l)}}}function Ot(n){let e,t,i=n[3]===null&&Ue(n);return{c(){i&&i.c(),e=de()},m(l,s){i&&i.m(l,s),B(l,e,s),t=!0},p(l,s){l[3]===null?i?(i.p(l,s),s[0]&8&&b(i,1)):(i=Ue(l),i.c(),b(i,1),i.m(e.parentNode,e)):i&&(X(),k(i,1,1,()=>{i=null}),Y())},i(l){t||(b(i),t=!0)},o(l){k(i),t=!1},d(l){l&&C(e),i&&i.d(l)}}}function Pt(n){let e,t,i,l,s;return t=new bt({props:{src:n[3].url,alt:n[3].alt_text}}),{c(){e=R("div"),q(t.$$.fragment),m(e,"class","image-frame svelte-1ti4ehe"),G(e,"selectable",n[11])},m(r,c){B(r,e,c),N(t,e,null),i=!0,l||(s=te(e,"click",n[27]),l=!0)},p(r,c){const a={};c[0]&8&&(a.src=r[3].url),c[0]&8&&(a.alt=r[3].alt_text),t.$set(a),(!i||c[0]&2048)&&G(e,"selectable",r[11])},i(r){i||(b(t.$$.fragment,r),i=!0)},o(r){k(t.$$.fragment,r),i=!1},d(r){r&&C(e),T(t),l=!1,s()}}}function Jt(n){let e,t,i,l;function s(a){n[36](a)}function r(a){n[37](a)}let c={root:n[12],value:n[3],mirror_webcam:n[10],stream_every:n[17],streaming:n[9],mode:"image",include_audio:!1,i18n:n[13],upload:n[15],webcam_constraints:n[19]};return n[4]!==void 0&&(c.modify_stream=n[4]),n[5]!==void 0&&(c.set_time_limit=n[5]),e=new Ft({props:c}),$.push(()=>ce(e,"modify_stream",s)),$.push(()=>ce(e,"set_time_limit",r)),e.$on("capture",n[38]),e.$on("stream",n[39]),e.$on("error",n[40]),e.$on("drag",n[41]),e.$on("upload",n[42]),e.$on("close_stream",n[43]),{c(){q(e.$$.fragment)},m(a,u){N(e,a,u),l=!0},p(a,u){const _={};u[0]&4096&&(_.root=a[12]),u[0]&8&&(_.value=a[3]),u[0]&1024&&(_.mirror_webcam=a[10]),u[0]&131072&&(_.stream_every=a[17]),u[0]&512&&(_.streaming=a[9]),u[0]&8192&&(_.i18n=a[13]),u[0]&32768&&(_.upload=a[15]),u[0]&524288&&(_.webcam_constraints=a[19]),!t&&u[0]&16&&(t=!0,_.modify_stream=a[4],ue(()=>t=!1)),!i&&u[0]&32&&(i=!0,_.set_time_limit=a[5],ue(()=>i=!1)),e.$set(_)},i(a){l||(b(e.$$.fragment,a),l=!0)},o(a){k(e.$$.fragment,a),l=!1},d(a){T(e,a)}}}function Le(n){let e,t,i;function l(r){n[44](r)}let s={sources:n[8],handle_clear:n[24],handle_select:n[28]};return n[1]!==void 0&&(s.active_source=n[1]),e=new ut({props:s}),$.push(()=>ce(e,"active_source",l)),{c(){q(e.$$.fragment)},m(r,c){N(e,r,c),i=!0},p(r,c){const a={};c[0]&256&&(a.sources=r[8]),!t&&c[0]&2&&(t=!0,a.active_source=r[1],ue(()=>t=!1)),e.$set(a)},i(r){i||(b(e.$$.fragment,r),i=!0)},o(r){k(e.$$.fragment,r),i=!1},d(r){T(e,r)}}}function Kt(n){let e,t,i,l,s,r,c,a,u,_,f,y,z,U=n[8].length>1||n[8].includes("clipboard"),h;e=new rt({props:{show_label:n[7],Icon:st,label:n[6]||"Image"}}),l=new ft({props:{$$slots:{default:[Ht]},$$scope:{ctx:n}}});function w(d){n[33](d)}function p(d){n[34](d)}let M={hidden:n[3]!==null||n[1]==="webcam",filetype:n[1]==="clipboard"?"clipboard":"image/*",root:n[12],max_file_size:n[14],disable_click:!n[8].includes("upload")||n[3]!==null,upload:n[15],stream_handler:n[16],$$slots:{default:[Ot]},$$scope:{ctx:n}};n[0]!==void 0&&(M.uploading=n[0]),n[2]!==void 0&&(M.dragging=n[2]),c=new ht({props:M}),n[32](c),$.push(()=>ce(c,"uploading",w)),$.push(()=>ce(c,"dragging",p)),c.$on("load",n[23]),c.$on("error",n[35]);const F=[Jt,Pt],E=[];function P(d,v){return d[1]==="webcam"&&(d[9]||!d[9]&&!d[3])?0:d[3]!==null&&!d[9]?1:-1}~(f=P(n))&&(y=E[f]=F[f](n));let W=U&&Le(n);return{c(){q(e.$$.fragment),t=A(),i=R("div"),q(l.$$.fragment),s=A(),r=R("div"),q(c.$$.fragment),_=A(),y&&y.c(),z=A(),W&&W.c(),m(r,"class","upload-container svelte-1ti4ehe"),G(r,"reduced-height",n[8].length>1),oe(r,"width",n[3]?"auto":"100%"),m(i,"data-testid","image"),m(i,"class","image-container svelte-1ti4ehe")},m(d,v){N(e,d,v),B(d,t,v),B(d,i,v),N(l,i,null),D(i,s),D(i,r),N(c,r,null),D(r,_),~f&&E[f].m(r,null),D(i,z),W&&W.m(i,null),n[45](i),h=!0},p(d,v){const H={};v[0]&128&&(H.show_label=d[7]),v[0]&64&&(H.label=d[6]||"Image"),e.$set(H);const L={};v[0]&5505032|v[1]&32768&&(L.$$scope={dirty:v,ctx:d}),l.$set(L);const j={};v[0]&10&&(j.hidden=d[3]!==null||d[1]==="webcam"),v[0]&2&&(j.filetype=d[1]==="clipboard"?"clipboard":"image/*"),v[0]&4096&&(j.root=d[12]),v[0]&16384&&(j.max_file_size=d[14]),v[0]&264&&(j.disable_click=!d[8].includes("upload")||d[3]!==null),v[0]&32768&&(j.upload=d[15]),v[0]&65536&&(j.stream_handler=d[16]),v[0]&8|v[1]&32768&&(j.$$scope={dirty:v,ctx:d}),!a&&v[0]&1&&(a=!0,j.uploading=d[0],ue(()=>a=!1)),!u&&v[0]&4&&(u=!0,j.dragging=d[2],ue(()=>u=!1)),c.$set(j);let J=f;f=P(d),f===J?~f&&E[f].p(d,v):(y&&(X(),k(E[J],1,1,()=>{E[J]=null}),Y()),~f?(y=E[f],y?y.p(d,v):(y=E[f]=F[f](d),y.c()),b(y,1),y.m(r,null)):y=null),(!h||v[0]&256)&&G(r,"reduced-height",d[8].length>1),v[0]&8&&oe(r,"width",d[3]?"auto":"100%"),v[0]&256&&(U=d[8].length>1||d[8].includes("clipboard")),U?W?(W.p(d,v),v[0]&256&&b(W,1)):(W=Le(d),W.c(),b(W,1),W.m(i,null)):W&&(X(),k(W,1,1,()=>{W=null}),Y())},i(d){h||(b(e.$$.fragment,d),b(l.$$.fragment,d),b(c.$$.fragment,d),b(y),b(W),h=!0)},o(d){k(e.$$.fragment,d),k(l.$$.fragment,d),k(c.$$.fragment,d),k(y),k(W),h=!1},d(d){d&&(C(t),C(i)),T(e,d),T(l),n[32](null),T(c),~f&&E[f].d(),W&&W.d(),n[45](null)}}}function Vt(n,e,t){let i,{$$slots:l={},$$scope:s}=e,{value:r=null}=e,{label:c=void 0}=e,{show_label:a}=e,{sources:u=["upload","clipboard","webcam"]}=e,{streaming:_=!1}=e,{pending:f=!1}=e,{mirror_webcam:y}=e,{selectable:z=!1}=e,{root:U}=e,{i18n:h}=e,{max_file_size:w=null}=e,{upload:p}=e,{stream_handler:M}=e,{stream_every:F}=e,{modify_stream:E}=e,{set_time_limit:P}=e,{show_fullscreen_button:W=!0}=e,d,{uploading:v=!1}=e,{active_source:H=null}=e,{webcam_constraints:L=void 0}=e;async function j({detail:o}){if(!_){if(o.path?.toLowerCase().endsWith(".svg")&&o.url){const De=await(await fetch(o.url)).text();t(3,r={...o,url:`data:image/svg+xml,${encodeURIComponent(De)}`})}else t(3,r=o);O("upload")}}function J(){t(3,r=null),O("clear"),O("change",null)}async function K(o,ee){if(ee==="stream"){O("stream",{value:{url:o},is_value_data:!0});return}t(29,f=!0);const De=await d.load_files([new File([o],`image/${_?"jpeg":"png"}`)]);(ee==="change"||ee==="upload")&&(t(3,r=De?.[0]||null),await $e(),O("change")),t(29,f=!1)}const O=Me();let{dragging:x=!1}=e;function le(o){let ee=_t(o);ee&&O("select",{index:ee,value:null})}async function ne(o){switch(o){case"clipboard":d.paste_clipboard();break}}let Z;const be=o=>{t(3,r=null),O("clear"),o.stopPropagation()};function we(o){$[o?"unshift":"push"](()=>{d=o,t(21,d)})}function pe(o){v=o,t(0,v)}function ve(o){x=o,t(2,x)}function ke(o){he.call(this,n,o)}function ye(o){E=o,t(4,E)}function g(o){P=o,t(5,P)}const S=o=>K(o.detail,"change"),V=o=>K(o.detail,"stream");function re(o){he.call(this,n,o)}function se(o){he.call(this,n,o)}const Ie=o=>K(o.detail,"upload");function Fe(o){he.call(this,n,o)}function He(o){H=o,t(1,H),t(8,u)}function Oe(o){$[o?"unshift":"push"](()=>{Z=o,t(22,Z)})}return n.$$set=o=>{"value"in o&&t(3,r=o.value),"label"in o&&t(6,c=o.label),"show_label"in o&&t(7,a=o.show_label),"sources"in o&&t(8,u=o.sources),"streaming"in o&&t(9,_=o.streaming),"pending"in o&&t(29,f=o.pending),"mirror_webcam"in o&&t(10,y=o.mirror_webcam),"selectable"in o&&t(11,z=o.selectable),"root"in o&&t(12,U=o.root),"i18n"in o&&t(13,h=o.i18n),"max_file_size"in o&&t(14,w=o.max_file_size),"upload"in o&&t(15,p=o.upload),"stream_handler"in o&&t(16,M=o.stream_handler),"stream_every"in o&&t(17,F=o.stream_every),"modify_stream"in o&&t(4,E=o.modify_stream),"set_time_limit"in o&&t(5,P=o.set_time_limit),"show_fullscreen_button"in o&&t(18,W=o.show_fullscreen_button),"uploading"in o&&t(0,v=o.uploading),"active_source"in o&&t(1,H=o.active_source),"webcam_constraints"in o&&t(19,L=o.webcam_constraints),"dragging"in o&&t(2,x=o.dragging),"$$scope"in o&&t(46,s=o.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&258&&!H&&u&&t(1,H=u[0]),n.$$.dirty[0]&514&&t(20,i=_&&H==="webcam"),n.$$.dirty[0]&1048577&&v&&!i&&t(3,r=null),n.$$.dirty[0]&4&&O("drag",x)},[v,H,x,r,E,P,c,a,u,_,y,z,U,h,w,p,M,F,W,L,i,d,Z,j,J,K,O,le,ne,f,l,be,we,pe,ve,ke,ye,g,S,V,re,se,Ie,Fe,He,Oe,s]}class Gt extends fe{constructor(e){super(),_e(this,e,Vt,Kt,me,{value:3,label:6,show_label:7,sources:8,streaming:9,pending:29,mirror_webcam:10,selectable:11,root:12,i18n:13,max_file_size:14,upload:15,stream_handler:16,stream_every:17,modify_stream:4,set_time_limit:5,show_fullscreen_button:18,uploading:0,active_source:1,webcam_constraints:19,dragging:2},null,[-1,-1])}get value(){return this.$$.ctx[3]}set value(e){this.$$set({value:e}),I()}get label(){return this.$$.ctx[6]}set label(e){this.$$set({label:e}),I()}get show_label(){return this.$$.ctx[7]}set show_label(e){this.$$set({show_label:e}),I()}get sources(){return this.$$.ctx[8]}set sources(e){this.$$set({sources:e}),I()}get streaming(){return this.$$.ctx[9]}set streaming(e){this.$$set({streaming:e}),I()}get pending(){return this.$$.ctx[29]}set pending(e){this.$$set({pending:e}),I()}get mirror_webcam(){return this.$$.ctx[10]}set mirror_webcam(e){this.$$set({mirror_webcam:e}),I()}get selectable(){return this.$$.ctx[11]}set selectable(e){this.$$set({selectable:e}),I()}get root(){return this.$$.ctx[12]}set root(e){this.$$set({root:e}),I()}get i18n(){return this.$$.ctx[13]}set i18n(e){this.$$set({i18n:e}),I()}get max_file_size(){return this.$$.ctx[14]}set max_file_size(e){this.$$set({max_file_size:e}),I()}get upload(){return this.$$.ctx[15]}set upload(e){this.$$set({upload:e}),I()}get stream_handler(){return this.$$.ctx[16]}set stream_handler(e){this.$$set({stream_handler:e}),I()}get stream_every(){return this.$$.ctx[17]}set stream_every(e){this.$$set({stream_every:e}),I()}get modify_stream(){return this.$$.ctx[4]}set modify_stream(e){this.$$set({modify_stream:e}),I()}get set_time_limit(){return this.$$.ctx[5]}set set_time_limit(e){this.$$set({set_time_limit:e}),I()}get show_fullscreen_button(){return this.$$.ctx[18]}set show_fullscreen_button(e){this.$$set({show_fullscreen_button:e}),I()}get uploading(){return this.$$.ctx[0]}set uploading(e){this.$$set({uploading:e}),I()}get active_source(){return this.$$.ctx[1]}set active_source(e){this.$$set({active_source:e}),I()}get webcam_constraints(){return this.$$.ctx[19]}set webcam_constraints(e){this.$$set({webcam_constraints:e}),I()}get dragging(){return this.$$.ctx[2]}set dragging(e){this.$$set({dragging:e}),I()}}const si=Gt;export{si as I,Ft as W};
//# sourceMappingURL=ImageUploader-Bp1C_INa.js.map
