import{a as ae,i as ue,s as re,E as De,z as g,d as M,C as S,D as ee,l as P,f as y,y as R,a5 as ye,aa as je,aq as Se,b as U,$ as le,H as z,b9 as Fe,bc as ze,R as Te,ar as me,c as A,A as K,m as I,k as E,h as te,t as T,j as ne,n as H,K as Z,a7 as $,a8 as x,e as he,w as ce,x as Ee,I as Ve,a1 as Re,ay as Oe,o as Ne,ax as We,p as G,G as Ge,J as Je}from"../lite.js";import{B as Ke}from"./BlockLabel-DWW9BWN3.js";import{E as Qe}from"./Empty-Dns-ytKL.js";import{S as Ye}from"./ShareButton-Be-vgu5O.js";import{D as Ze}from"./Download-RUpc9r8A.js";import{V as Xe}from"./Video-4rA7HTQG.js";import{I as $e}from"./IconButtonWrapper-BQG8MTSb.js";import{f as oe,u as xe}from"./utils-BsGrhMNe.js";import{D as et}from"./DownloadLink-CqqU4pZ8.js";import{T as tt,P as nt}from"./Trim-CDsEvQ4G.js";import{P as lt}from"./Play-BIkNyEKH.js";import{U as Ue}from"./Undo-50qkik3g.js";import{b as it,t as ot,V as rt}from"./Video-zUTMfTm-.js";/* empty css                                             */import{M as st}from"./ModifyUpload-1XV0j9uc.js";function at(l){let e,n;return{c(){e=De("svg"),n=De("path"),g(n,"d","M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"),g(e,"xmlns","http://www.w3.org/2000/svg"),g(e,"width","100%"),g(e,"height","100%"),g(e,"viewBox","0 0 24 24"),g(e,"fill","none"),g(e,"stroke","currentColor"),g(e,"stroke-width","1.5"),g(e,"stroke-linecap","round"),g(e,"stroke-linejoin","round")},m(t,i){M(t,e,i),S(e,n)},p:ee,i:ee,o:ee,d(t){t&&P(e)}}}class ut extends ae{constructor(e){super(),ue(this,e,null,at,re,{})}}function Le(l,e,n){const t=l.slice();return t[20]=e[n],t[22]=n,t}function ft(l){let e,n,t,i,o,r=[],s=new Map,_,b,f,u,d=Se(l[1]);const c=v=>v[22];for(let v=0;v<d.length;v+=1){let k=Le(l,d,v),V=c(k);s.set(V,r[v]=Me(V,k))}return{c(){e=R("div"),n=R("button"),t=U(),i=R("div"),o=U();for(let v=0;v<r.length;v+=1)r[v].c();_=U(),b=R("button"),g(n,"aria-label","start drag handle for trimming video"),g(n,"class","handle left svelte-10c4beq"),le(n,"left",l[2]+"%"),g(i,"class","opaque-layer svelte-10c4beq"),le(i,"left",l[2]+"%"),le(i,"right",100-l[3]+"%"),g(b,"aria-label","end drag handle for trimming video"),g(b,"class","handle right svelte-10c4beq"),le(b,"left",l[3]+"%"),g(e,"id","timeline"),g(e,"class","thumbnail-wrapper svelte-10c4beq")},m(v,k){M(v,e,k),S(e,n),S(e,t),S(e,i),S(e,o);for(let V=0;V<r.length;V+=1)r[V]&&r[V].m(e,null);S(e,_),S(e,b),f||(u=[z(n,"mousedown",l[10]),z(n,"blur",l[5]),z(n,"keydown",l[11]),z(b,"mousedown",l[12]),z(b,"blur",l[5]),z(b,"keydown",l[13])],f=!0)},p(v,k){k&4&&le(n,"left",v[2]+"%"),k&4&&le(i,"left",v[2]+"%"),k&8&&le(i,"right",100-v[3]+"%"),k&2&&(d=Se(v[1]),r=Fe(r,k,c,1,v,d,s,e,ze,Me,_,Le)),k&8&&le(b,"left",v[3]+"%")},d(v){v&&P(e);for(let k=0;k<r.length;k+=1)r[k].d();f=!1,Te(u)}}}function dt(l){let e;return{c(){e=R("div"),e.innerHTML='<span aria-label="loading timeline" class="loader svelte-10c4beq"></span>',g(e,"class","load-wrap svelte-10c4beq")},m(n,t){M(n,e,t)},p:ee,d(n){n&&P(e)}}}function Me(l,e){let n,t,i;return{key:l,first:null,c(){n=R("img"),me(n.src,t=e[20])||g(n,"src",t),g(n,"alt",i=`frame-${e[22]}`),g(n,"draggable","false"),g(n,"class","svelte-10c4beq"),this.first=n},m(o,r){M(o,n,r)},p(o,r){e=o,r&2&&!me(n.src,t=e[20])&&g(n,"src",t),r&2&&i!==(i=`frame-${e[22]}`)&&g(n,"alt",i)},d(o){o&&P(n)}}}function _t(l){let e;function n(o,r){return o[0]?dt:ft}let t=n(l),i=t(l);return{c(){e=R("div"),i.c(),g(e,"class","container svelte-10c4beq")},m(o,r){M(o,e,r),i.m(e,null)},p(o,[r]){t===(t=n(o))&&i?i.p(o,r):(i.d(1),i=t(o),i&&(i.c(),i.m(e,null)))},i:ee,o:ee,d(o){o&&P(e),i.d()}}}let pe=10;function ct(l,e,n){let{videoElement:t}=e,{trimmedDuration:i}=e,{dragStart:o}=e,{dragEnd:r}=e,{loadingTimeline:s}=e,_=[],b,f=0,u=100,d=null;const c=h=>{d=h},v=()=>{d=null},k=(h,L)=>{if(d){const D=document.getElementById("timeline");if(!D)return;const m=D.getBoundingClientRect();let B=(h.clientX-m.left)/m.width*100;if(L?B=d==="left"?f+L:u+L:B=(h.clientX-m.left)/m.width*100,B=Math.max(0,Math.min(B,100)),d==="left"){n(2,f=Math.min(B,u));const X=f/100*b;n(6,t.currentTime=X,t),n(8,o=X)}else if(d==="right"){n(3,u=Math.max(B,f));const X=u/100*b;n(6,t.currentTime=X,t),n(9,r=X)}const Q=f/100*b,p=u/100*b;n(7,i=p-Q),n(2,f),n(3,u)}},V=h=>{if(d){const L=1/b*100;h.key==="ArrowLeft"?k({clientX:0},-L):h.key==="ArrowRight"&&k({clientX:0},L)}},j=()=>{const h=document.createElement("canvas"),L=h.getContext("2d");if(!L)return;h.width=t.videoWidth,h.height=t.videoHeight,L.drawImage(t,0,0,h.width,h.height);const D=h.toDataURL("image/jpeg",.7);n(1,_=[..._,D])};ye(()=>{const h=()=>{b=t.duration;const L=b/pe;let D=0;const m=()=>{j(),D++,D<pe?n(6,t.currentTime+=L,t):t.removeEventListener("seeked",m)};t.addEventListener("seeked",m),n(6,t.currentTime=0,t)};t.readyState>=1?h():t.addEventListener("loadedmetadata",h)}),je(()=>{window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",v),window.removeEventListener("keydown",V)}),ye(()=>{window.addEventListener("mousemove",k),window.addEventListener("mouseup",v),window.addEventListener("keydown",V)});const O=()=>c("left"),F=h=>{(h.key==="ArrowLeft"||h.key=="ArrowRight")&&c("left")},W=()=>c("right"),N=h=>{(h.key==="ArrowLeft"||h.key=="ArrowRight")&&c("right")};return l.$$set=h=>{"videoElement"in h&&n(6,t=h.videoElement),"trimmedDuration"in h&&n(7,i=h.trimmedDuration),"dragStart"in h&&n(8,o=h.dragStart),"dragEnd"in h&&n(9,r=h.dragEnd),"loadingTimeline"in h&&n(0,s=h.loadingTimeline)},l.$$.update=()=>{l.$$.dirty&2&&n(0,s=_.length!==pe)},[s,_,f,u,c,v,t,i,o,r,O,F,W,N]}class mt extends ae{constructor(e){super(),ue(this,e,ct,_t,re,{videoElement:6,trimmedDuration:7,dragStart:8,dragEnd:9,loadingTimeline:0})}get videoElement(){return this.$$.ctx[6]}set videoElement(e){this.$$set({videoElement:e}),y()}get trimmedDuration(){return this.$$.ctx[7]}set trimmedDuration(e){this.$$set({trimmedDuration:e}),y()}get dragStart(){return this.$$.ctx[8]}set dragStart(e){this.$$set({dragStart:e}),y()}get dragEnd(){return this.$$.ctx[9]}set dragEnd(e){this.$$set({dragEnd:e}),y()}get loadingTimeline(){return this.$$.ctx[0]}set loadingTimeline(e){this.$$set({loadingTimeline:e}),y()}}function Pe(l){let e,n,t,i,o,r,s;function _(c){l[18](c)}function b(c){l[19](c)}function f(c){l[20](c)}function u(c){l[21](c)}let d={videoElement:l[2]};return l[14]!==void 0&&(d.dragStart=l[14]),l[15]!==void 0&&(d.dragEnd=l[15]),l[12]!==void 0&&(d.trimmedDuration=l[12]),l[16]!==void 0&&(d.loadingTimeline=l[16]),n=new mt({props:d}),Z.push(()=>$(n,"dragStart",_)),Z.push(()=>$(n,"dragEnd",b)),Z.push(()=>$(n,"trimmedDuration",f)),Z.push(()=>$(n,"loadingTimeline",u)),{c(){e=R("div"),A(n.$$.fragment),g(e,"class","timeline-wrapper svelte-7yrr5f")},m(c,v){M(c,e,v),I(n,e,null),s=!0},p(c,v){const k={};v&4&&(k.videoElement=c[2]),!t&&v&16384&&(t=!0,k.dragStart=c[14],x(()=>t=!1)),!i&&v&32768&&(i=!0,k.dragEnd=c[15],x(()=>i=!1)),!o&&v&4096&&(o=!0,k.trimmedDuration=c[12],x(()=>o=!1)),!r&&v&65536&&(r=!0,k.loadingTimeline=c[16],x(()=>r=!1)),n.$set(k)},i(c){s||(E(n.$$.fragment,c),s=!0)},o(c){T(n.$$.fragment,c),s=!1},d(c){c&&P(e),H(n)}}}function ht(l){let e;return{c(){e=R("div"),g(e,"class","svelte-7yrr5f")},m(n,t){M(n,e,t)},p:ee,d(n){n&&P(e)}}}function gt(l){let e,n=oe(l[12])+"",t,i,o,r,s,_,b,f;return{c(){e=R("time"),t=ce(n),i=U(),o=R("div"),r=R("button"),r.textContent="Trim",s=U(),_=R("button"),_.textContent="Cancel",g(e,"aria-label","duration of selected region in seconds"),g(e,"class","svelte-7yrr5f"),K(e,"hidden",l[16]),g(r,"class","text-button svelte-7yrr5f"),K(r,"hidden",l[16]),g(_,"class","text-button svelte-7yrr5f"),K(_,"hidden",l[16]),g(o,"class","edit-buttons svelte-7yrr5f")},m(u,d){M(u,e,d),S(e,t),M(u,i,d),M(u,o,d),S(o,r),S(o,s),S(o,_),b||(f=[z(r,"click",l[22]),z(_,"click",l[17])],b=!0)},p(u,d){d&4096&&n!==(n=oe(u[12])+"")&&Ee(t,n),d&65536&&K(e,"hidden",u[16]),d&65536&&K(r,"hidden",u[16]),d&65536&&K(_,"hidden",u[16])},d(u){u&&(P(e),P(i),P(o)),b=!1,Te(f)}}}function qe(l){let e,n;return e=new Ve({props:{Icon:Ue,label:"Reset video to initial value",disabled:l[1]||!l[11]}}),e.$on("click",l[23]),{c(){A(e.$$.fragment)},m(t,i){I(e,t,i),n=!0},p(t,i){const o={};i&2050&&(o.disabled=t[1]||!t[11]),e.$set(o)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Ce(l){let e,n;return e=new Ve({props:{Icon:tt,label:"Trim video to selection",disabled:l[1]}}),e.$on("click",l[17]),{c(){A(e.$$.fragment)},m(t,i){I(e,t,i),n=!0},p(t,i){const o={};i&2&&(o.disabled=t[1]),e.$set(o)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function bt(l){let e,n,t,i=l[3]&&l[0]===""&&qe(l),o=l[4]&&l[0]===""&&Ce(l);return{c(){i&&i.c(),e=U(),o&&o.c(),n=he()},m(r,s){i&&i.m(r,s),M(r,e,s),o&&o.m(r,s),M(r,n,s),t=!0},p(r,s){r[3]&&r[0]===""?i?(i.p(r,s),s&9&&E(i,1)):(i=qe(r),i.c(),E(i,1),i.m(e.parentNode,e)):i&&(te(),T(i,1,1,()=>{i=null}),ne()),r[4]&&r[0]===""?o?(o.p(r,s),s&17&&E(o,1)):(o=Ce(r),o.c(),E(o,1),o.m(n.parentNode,n)):o&&(te(),T(o,1,1,()=>{o=null}),ne())},i(r){t||(E(i),E(o),t=!0)},o(r){T(i),T(o),t=!1},d(r){r&&(P(e),P(n)),i&&i.d(r),o&&o.d(r)}}}function wt(l){let e,n,t,i,o,r,s=l[0]==="edit"&&Pe(l);function _(u,d){return u[0]==="edit"&&u[12]!==null?gt:ht}let b=_(l),f=b(l);return o=new st({props:{i18n:l[7],download:l[9]?l[8]?.url:null,$$slots:{default:[bt]},$$scope:{ctx:l}}}),o.$on("clear",l[24]),{c(){e=R("div"),s&&s.c(),n=U(),t=R("div"),f.c(),i=U(),A(o.$$.fragment),g(t,"class","controls svelte-7yrr5f"),g(t,"data-testid","waveform-controls"),g(e,"class","container svelte-7yrr5f"),K(e,"hidden",l[0]!=="edit")},m(u,d){M(u,e,d),s&&s.m(e,null),S(e,n),S(e,t),f.m(t,null),M(u,i,d),I(o,u,d),r=!0},p(u,[d]){u[0]==="edit"?s?(s.p(u,d),d&1&&E(s,1)):(s=Pe(u),s.c(),E(s,1),s.m(e,n)):s&&(te(),T(s,1,1,()=>{s=null}),ne()),b===(b=_(u))&&f?f.p(u,d):(f.d(1),f=b(u),f&&(f.c(),f.m(t,null))),(!r||d&1)&&K(e,"hidden",u[0]!=="edit");const c={};d&128&&(c.i18n=u[7]),d&768&&(c.download=u[9]?u[8]?.url:null),d&33556539&&(c.$$scope={dirty:d,ctx:u}),o.$set(c)},i(u){r||(E(s),E(o.$$.fragment,u),r=!0)},o(u){T(s),T(o.$$.fragment,u),r=!1},d(u){u&&(P(e),P(i)),s&&s.d(),f.d(),H(o,u)}}}function vt(l,e,n){let{videoElement:t}=e,{showRedo:i=!1}=e,{interactive:o=!0}=e,{mode:r=""}=e,{handle_reset_value:s}=e,{handle_trim_video:_}=e,{processingVideo:b=!1}=e,{i18n:f}=e,{value:u=null}=e,{show_download_button:d=!1}=e,{handle_clear:c=()=>{}}=e,{has_change_history:v=!1}=e,k;ye(async()=>{n(13,k=await it())});let V=null,j=0,O=0,F=!1;const W=()=>{r==="edit"?(n(0,r=""),n(12,V=t.duration)):n(0,r="edit")};function N(p){j=p,n(14,j)}function h(p){O=p,n(15,O)}function L(p){V=p,n(12,V),n(0,r),n(2,t)}function D(p){F=p,n(16,F)}const m=()=>{n(0,r=""),n(1,b=!0),ot(k,j,O,t).then(p=>{_(p)}).then(()=>{n(1,b=!1)})},B=()=>{s(),n(0,r="")},Q=()=>c();return l.$$set=p=>{"videoElement"in p&&n(2,t=p.videoElement),"showRedo"in p&&n(3,i=p.showRedo),"interactive"in p&&n(4,o=p.interactive),"mode"in p&&n(0,r=p.mode),"handle_reset_value"in p&&n(5,s=p.handle_reset_value),"handle_trim_video"in p&&n(6,_=p.handle_trim_video),"processingVideo"in p&&n(1,b=p.processingVideo),"i18n"in p&&n(7,f=p.i18n),"value"in p&&n(8,u=p.value),"show_download_button"in p&&n(9,d=p.show_download_button),"handle_clear"in p&&n(10,c=p.handle_clear),"has_change_history"in p&&n(11,v=p.has_change_history)},l.$$.update=()=>{l.$$.dirty&4101&&r==="edit"&&V===null&&t&&n(12,V=t.duration)},[r,b,t,i,o,s,_,f,u,d,c,v,V,k,j,O,F,W,N,h,L,D,m,B,Q]}class kt extends ae{constructor(e){super(),ue(this,e,vt,wt,re,{videoElement:2,showRedo:3,interactive:4,mode:0,handle_reset_value:5,handle_trim_video:6,processingVideo:1,i18n:7,value:8,show_download_button:9,handle_clear:10,has_change_history:11})}get videoElement(){return this.$$.ctx[2]}set videoElement(e){this.$$set({videoElement:e}),y()}get showRedo(){return this.$$.ctx[3]}set showRedo(e){this.$$set({showRedo:e}),y()}get interactive(){return this.$$.ctx[4]}set interactive(e){this.$$set({interactive:e}),y()}get mode(){return this.$$.ctx[0]}set mode(e){this.$$set({mode:e}),y()}get handle_reset_value(){return this.$$.ctx[5]}set handle_reset_value(e){this.$$set({handle_reset_value:e}),y()}get handle_trim_video(){return this.$$.ctx[6]}set handle_trim_video(e){this.$$set({handle_trim_video:e}),y()}get processingVideo(){return this.$$.ctx[1]}set processingVideo(e){this.$$set({processingVideo:e}),y()}get i18n(){return this.$$.ctx[7]}set i18n(e){this.$$set({i18n:e}),y()}get value(){return this.$$.ctx[8]}set value(e){this.$$set({value:e}),y()}get show_download_button(){return this.$$.ctx[9]}set show_download_button(e){this.$$set({show_download_button:e}),y()}get handle_clear(){return this.$$.ctx[10]}set handle_clear(e){this.$$set({handle_clear:e}),y()}get has_change_history(){return this.$$.ctx[11]}set has_change_history(e){this.$$set({has_change_history:e}),y()}}function pt(l){let e,n;return{c(){e=R("track"),g(e,"kind","captions"),me(e.src,n=l[1])||g(e,"src",n),e.default=!0},m(t,i){M(t,e,i)},p(t,i){i[0]&2&&!me(e.src,n=t[1])&&g(e,"src",n)},d(t){t&&P(e)}}}function yt(l){let e,n;return e=new nt({}),{c(){A(e.$$.fragment)},m(t,i){I(e,t,i),n=!0},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Et(l){let e,n;return e=new lt({}),{c(){A(e.$$.fragment)},m(t,i){I(e,t,i),n=!0},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Tt(l){let e,n;return e=new Ue({}),{c(){A(e.$$.fragment)},m(t,i){I(e,t,i),n=!0},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Be(l){let e,n,t;function i(r){l[37](r)}let o={videoElement:l[17],showRedo:!0,handle_trim_video:l[23],handle_reset_value:l[7],value:l[11],i18n:l[9],show_download_button:l[10],handle_clear:l[12],has_change_history:l[13]};return l[18]!==void 0&&(o.processingVideo=l[18]),e=new kt({props:o}),Z.push(()=>$(e,"processingVideo",i)),{c(){A(e.$$.fragment)},m(r,s){I(e,r,s),t=!0},p(r,s){const _={};s[0]&131072&&(_.videoElement=r[17]),s[0]&128&&(_.handle_reset_value=r[7]),s[0]&2048&&(_.value=r[11]),s[0]&512&&(_.i18n=r[9]),s[0]&1024&&(_.show_download_button=r[10]),s[0]&4096&&(_.handle_clear=r[12]),s[0]&8192&&(_.has_change_history=r[13]),!n&&s[0]&262144&&(n=!0,_.processingVideo=r[18],x(()=>n=!1)),e.$set(_)},i(r){t||(E(e.$$.fragment,r),t=!0)},o(r){T(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function Vt(l){let e,n,t,i,o,r,s,_,b,f,u,d,c,v,k,V=oe(l[14])+"",j,O,F=oe(l[15])+"",W,N,h,L,D,m,B,Q,p,X,se,fe;function ge(w){l[28](w)}function be(w){l[29](w)}function we(w){l[30](w)}function ve(w){l[31](w)}let ie={src:l[0],preload:"auto",autoplay:l[3],loop:l[4],is_stream:l[8],"data-testid":`${l[5]}-player`,processingVideo:l[18],$$slots:{default:[pt]},$$scope:{ctx:l}};l[14]!==void 0&&(ie.currentTime=l[14]),l[15]!==void 0&&(ie.duration=l[15]),l[16]!==void 0&&(ie.paused=l[16]),l[17]!==void 0&&(ie.node=l[17]),t=new rt({props:ie}),Z.push(()=>$(t,"currentTime",ge)),Z.push(()=>$(t,"duration",be)),Z.push(()=>$(t,"paused",we)),Z.push(()=>$(t,"node",ve)),t.$on("click",l[20]),t.$on("play",l[32]),t.$on("pause",l[33]),t.$on("ended",l[22]),t.$on("loadstart",l[34]),t.$on("loadeddata",l[35]),t.$on("loadedmetadata",l[36]);const de=[Tt,Et,yt],Y=[];function _e(w,a){return w[14]===w[15]?0:w[16]?1:2}d=_e(l),c=Y[d]=de[d](l),B=new ut({});let q=l[6]&&Be(l);return{c(){e=R("div"),n=R("div"),A(t.$$.fragment),_=U(),b=R("div"),f=R("div"),u=R("span"),c.c(),v=U(),k=R("span"),j=ce(V),O=ce(" / "),W=ce(F),N=U(),h=R("progress"),D=U(),m=R("div"),A(B.$$.fragment),Q=U(),q&&q.c(),p=he(),g(n,"class","mirror-wrap svelte-euo1cw"),K(n,"mirror",l[2]),g(u,"role","button"),g(u,"tabindex","0"),g(u,"class","icon svelte-euo1cw"),g(u,"aria-label","play-pause-replay-button"),g(k,"class","time svelte-euo1cw"),h.value=L=l[14]/l[15]||0,g(h,"class","svelte-euo1cw"),g(m,"role","button"),g(m,"tabindex","0"),g(m,"class","icon svelte-euo1cw"),g(m,"aria-label","full-screen"),g(f,"class","inner svelte-euo1cw"),g(b,"class","controls svelte-euo1cw"),g(e,"class","wrap svelte-euo1cw")},m(w,a){M(w,e,a),S(e,n),I(t,n,null),S(e,_),S(e,b),S(b,f),S(f,u),Y[d].m(u,null),S(f,v),S(f,k),S(k,j),S(k,O),S(k,W),S(f,N),S(f,h),S(f,D),S(f,m),I(B,m,null),M(w,Q,a),q&&q.m(w,a),M(w,p,a),X=!0,se||(fe=[z(u,"click",l[20]),z(u,"keydown",l[20]),z(h,"mousemove",l[19]),z(h,"touchmove",Re(l[19])),z(h,"click",Oe(Re(l[21]))),z(m,"click",l[24]),z(m,"keypress",l[24])],se=!0)},p(w,a){const C={};a[0]&1&&(C.src=w[0]),a[0]&8&&(C.autoplay=w[3]),a[0]&16&&(C.loop=w[4]),a[0]&256&&(C.is_stream=w[8]),a[0]&32&&(C["data-testid"]=`${w[5]}-player`),a[0]&262144&&(C.processingVideo=w[18]),a[0]&2|a[1]&256&&(C.$$scope={dirty:a,ctx:w}),!i&&a[0]&16384&&(i=!0,C.currentTime=w[14],x(()=>i=!1)),!o&&a[0]&32768&&(o=!0,C.duration=w[15],x(()=>o=!1)),!r&&a[0]&65536&&(r=!0,C.paused=w[16],x(()=>r=!1)),!s&&a[0]&131072&&(s=!0,C.node=w[17],x(()=>s=!1)),t.$set(C),(!X||a[0]&4)&&K(n,"mirror",w[2]);let J=d;d=_e(w),d!==J&&(te(),T(Y[J],1,1,()=>{Y[J]=null}),ne(),c=Y[d],c||(c=Y[d]=de[d](w),c.c()),E(c,1),c.m(u,null)),(!X||a[0]&16384)&&V!==(V=oe(w[14])+"")&&Ee(j,V),(!X||a[0]&32768)&&F!==(F=oe(w[15])+"")&&Ee(W,F),(!X||a[0]&49152&&L!==(L=w[14]/w[15]||0))&&(h.value=L),w[6]?q?(q.p(w,a),a[0]&64&&E(q,1)):(q=Be(w),q.c(),E(q,1),q.m(p.parentNode,p)):q&&(te(),T(q,1,1,()=>{q=null}),ne())},i(w){X||(E(t.$$.fragment,w),E(c),E(B.$$.fragment,w),E(q),X=!0)},o(w){T(t.$$.fragment,w),T(c),T(B.$$.fragment,w),T(q),X=!1},d(w){w&&(P(e),P(Q),P(p)),H(t),Y[d].d(),H(B),q&&q.d(w),se=!1,Te(fe)}}}function Dt(l,e,n){let{root:t=""}=e,{src:i}=e,{subtitle:o=null}=e,{mirror:r}=e,{autoplay:s}=e,{loop:_}=e,{label:b="test"}=e,{interactive:f=!1}=e,{handle_change:u=()=>{}}=e,{handle_reset_value:d=()=>{}}=e,{upload:c}=e,{is_stream:v}=e,{i18n:k}=e,{show_download_button:V=!1}=e,{value:j=null}=e,{handle_clear:O=()=>{}}=e,{has_change_history:F=!1}=e;const W=Ne();let N=0,h,L=!0,D,m=!1;function B(a){if(!h)return;if(a.type==="click"){p(a);return}if(a.type!=="touchmove"&&!(a.buttons&1))return;const C=a.type==="touchmove"?a.touches[0].clientX:a.clientX,{left:J,right:ke}=a.currentTarget.getBoundingClientRect();n(14,N=h*(C-J)/(ke-J))}async function Q(){document.fullscreenElement!=D&&(D.currentTime>0&&!D.paused&&!D.ended&&D.readyState>D.HAVE_CURRENT_DATA?D.pause():await D.play())}function p(a){const{left:C,right:J}=a.currentTarget.getBoundingClientRect();n(14,N=h*(a.clientX-C)/(J-C))}function X(){W("stop"),W("end")}const se=async a=>{let C=new File([a],"video.mp4");const J=await We([C]);let ke=(await c(J,t))?.filter(Boolean)[0];u(ke)};function fe(){D.requestFullscreen()}function ge(a){N=a,n(14,N)}function be(a){h=a,n(15,h)}function we(a){L=a,n(16,L)}function ve(a){D=a,n(17,D)}function ie(a){G.call(this,l,a)}function de(a){G.call(this,l,a)}function Y(a){G.call(this,l,a)}function _e(a){G.call(this,l,a)}function q(a){G.call(this,l,a)}function w(a){m=a,n(18,m)}return l.$$set=a=>{"root"in a&&n(25,t=a.root),"src"in a&&n(0,i=a.src),"subtitle"in a&&n(1,o=a.subtitle),"mirror"in a&&n(2,r=a.mirror),"autoplay"in a&&n(3,s=a.autoplay),"loop"in a&&n(4,_=a.loop),"label"in a&&n(5,b=a.label),"interactive"in a&&n(6,f=a.interactive),"handle_change"in a&&n(26,u=a.handle_change),"handle_reset_value"in a&&n(7,d=a.handle_reset_value),"upload"in a&&n(27,c=a.upload),"is_stream"in a&&n(8,v=a.is_stream),"i18n"in a&&n(9,k=a.i18n),"show_download_button"in a&&n(10,V=a.show_download_button),"value"in a&&n(11,j=a.value),"handle_clear"in a&&n(12,O=a.handle_clear),"has_change_history"in a&&n(13,F=a.has_change_history)},l.$$.update=()=>{l.$$.dirty[0]&16384&&n(14,N=N||0),l.$$.dirty[0]&32768&&n(15,h=h||0)},[i,o,r,s,_,b,f,d,v,k,V,j,O,F,N,h,L,D,m,B,Q,p,X,se,fe,t,u,c,ge,be,we,ve,ie,de,Y,_e,q,w]}class St extends ae{constructor(e){super(),ue(this,e,Dt,Vt,re,{root:25,src:0,subtitle:1,mirror:2,autoplay:3,loop:4,label:5,interactive:6,handle_change:26,handle_reset_value:7,upload:27,is_stream:8,i18n:9,show_download_button:10,value:11,handle_clear:12,has_change_history:13},null,[-1,-1])}get root(){return this.$$.ctx[25]}set root(e){this.$$set({root:e}),y()}get src(){return this.$$.ctx[0]}set src(e){this.$$set({src:e}),y()}get subtitle(){return this.$$.ctx[1]}set subtitle(e){this.$$set({subtitle:e}),y()}get mirror(){return this.$$.ctx[2]}set mirror(e){this.$$set({mirror:e}),y()}get autoplay(){return this.$$.ctx[3]}set autoplay(e){this.$$set({autoplay:e}),y()}get loop(){return this.$$.ctx[4]}set loop(e){this.$$set({loop:e}),y()}get label(){return this.$$.ctx[5]}set label(e){this.$$set({label:e}),y()}get interactive(){return this.$$.ctx[6]}set interactive(e){this.$$set({interactive:e}),y()}get handle_change(){return this.$$.ctx[26]}set handle_change(e){this.$$set({handle_change:e}),y()}get handle_reset_value(){return this.$$.ctx[7]}set handle_reset_value(e){this.$$set({handle_reset_value:e}),y()}get upload(){return this.$$.ctx[27]}set upload(e){this.$$set({upload:e}),y()}get is_stream(){return this.$$.ctx[8]}set is_stream(e){this.$$set({is_stream:e}),y()}get i18n(){return this.$$.ctx[9]}set i18n(e){this.$$set({i18n:e}),y()}get show_download_button(){return this.$$.ctx[10]}set show_download_button(e){this.$$set({show_download_button:e}),y()}get value(){return this.$$.ctx[11]}set value(e){this.$$set({value:e}),y()}get handle_clear(){return this.$$.ctx[12]}set handle_clear(e){this.$$set({handle_clear:e}),y()}get has_change_history(){return this.$$.ctx[13]}set has_change_history(e){this.$$set({has_change_history:e}),y()}}const Rt=St;function Lt(l){let e=l[0].url,n,t,i,o,r=Ae(l);return i=new $e({props:{display_top_corner:l[10],$$slots:{default:[qt]},$$scope:{ctx:l}}}),{c(){r.c(),n=U(),t=R("div"),A(i.$$.fragment),g(t,"data-testid","download-div")},m(s,_){r.m(s,_),M(s,n,_),M(s,t,_),I(i,t,null),o=!0},p(s,_){_&1&&re(e,e=s[0].url)?(te(),T(r,1,1,ee),ne(),r=Ae(s),r.c(),E(r,1),r.m(n.parentNode,n)):r.p(s,_);const b={};_&1024&&(b.display_top_corner=s[10]),_&4194657&&(b.$$scope={dirty:_,ctx:s}),i.$set(b)},i(s){o||(E(r),E(i.$$.fragment,s),o=!0)},o(s){T(r),T(i.$$.fragment,s),o=!1},d(s){s&&(P(n),P(t)),r.d(s),H(i)}}}function Mt(l){let e,n;return e=new Qe({props:{unpadded_box:!0,size:"large",$$slots:{default:[Ct]},$$scope:{ctx:l}}}),{c(){A(e.$$.fragment)},m(t,i){I(e,t,i),n=!0},p(t,i){const o={};i&4194304&&(o.$$scope={dirty:i,ctx:t}),e.$set(o)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Ae(l){let e,n;return e=new Rt({props:{src:l[0].url,subtitle:l[1]?.url,is_stream:l[0].is_stream,autoplay:l[4],mirror:!1,label:l[2],loop:l[7],interactive:!1,upload:l[9],i18n:l[8]}}),e.$on("play",l[12]),e.$on("pause",l[13]),e.$on("stop",l[14]),e.$on("end",l[15]),e.$on("loadedmetadata",l[16]),{c(){A(e.$$.fragment)},m(t,i){I(e,t,i),n=!0},p(t,i){const o={};i&1&&(o.src=t[0].url),i&2&&(o.subtitle=t[1]?.url),i&1&&(o.is_stream=t[0].is_stream),i&16&&(o.autoplay=t[4]),i&4&&(o.label=t[2]),i&128&&(o.loop=t[7]),i&512&&(o.upload=t[9]),i&256&&(o.i18n=t[8]),e.$set(o)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Ie(l){let e,n;return e=new et({props:{href:l[0].is_stream?l[0].url?.replace("playlist.m3u8","playlist-file"):l[0].url,download:l[0].orig_name||l[0].path,$$slots:{default:[Pt]},$$scope:{ctx:l}}}),{c(){A(e.$$.fragment)},m(t,i){I(e,t,i),n=!0},p(t,i){const o={};i&1&&(o.href=t[0].is_stream?t[0].url?.replace("playlist.m3u8","playlist-file"):t[0].url),i&1&&(o.download=t[0].orig_name||t[0].path),i&4194304&&(o.$$scope={dirty:i,ctx:t}),e.$set(o)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Pt(l){let e,n;return e=new Ve({props:{Icon:Ze,label:"Download"}}),{c(){A(e.$$.fragment)},m(t,i){I(e,t,i),n=!0},p:ee,i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function He(l){let e,n;return e=new Ye({props:{i18n:l[8],value:l[0],formatter:l[17]}}),e.$on("error",l[18]),e.$on("share",l[19]),{c(){A(e.$$.fragment)},m(t,i){I(e,t,i),n=!0},p(t,i){const o={};i&256&&(o.i18n=t[8]),i&1&&(o.value=t[0]),e.$set(o)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function qt(l){let e,n,t,i=l[6]&&Ie(l),o=l[5]&&He(l);return{c(){i&&i.c(),e=U(),o&&o.c(),n=he()},m(r,s){i&&i.m(r,s),M(r,e,s),o&&o.m(r,s),M(r,n,s),t=!0},p(r,s){r[6]?i?(i.p(r,s),s&64&&E(i,1)):(i=Ie(r),i.c(),E(i,1),i.m(e.parentNode,e)):i&&(te(),T(i,1,1,()=>{i=null}),ne()),r[5]?o?(o.p(r,s),s&32&&E(o,1)):(o=He(r),o.c(),E(o,1),o.m(n.parentNode,n)):o&&(te(),T(o,1,1,()=>{o=null}),ne())},i(r){t||(E(i),E(o),t=!0)},o(r){T(i),T(o),t=!1},d(r){r&&(P(e),P(n)),i&&i.d(r),o&&o.d(r)}}}function Ct(l){let e,n;return e=new Xe({}),{c(){A(e.$$.fragment)},m(t,i){I(e,t,i),n=!0},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Bt(l){let e,n,t,i,o,r;e=new Ke({props:{show_label:l[3],Icon:Xe,label:l[2]||"Video"}});const s=[Mt,Lt],_=[];function b(f,u){return!f[0]||f[0].url===void 0?0:1}return t=b(l),i=_[t]=s[t](l),{c(){A(e.$$.fragment),n=U(),i.c(),o=he()},m(f,u){I(e,f,u),M(f,n,u),_[t].m(f,u),M(f,o,u),r=!0},p(f,[u]){const d={};u&8&&(d.show_label=f[3]),u&4&&(d.label=f[2]||"Video"),e.$set(d);let c=t;t=b(f),t===c?_[t].p(f,u):(te(),T(_[c],1,1,()=>{_[c]=null}),ne(),i=_[t],i?i.p(f,u):(i=_[t]=s[t](f),i.c()),E(i,1),i.m(o.parentNode,o))},i(f){r||(E(e.$$.fragment,f),E(i),r=!0)},o(f){T(e.$$.fragment,f),T(i),r=!1},d(f){f&&(P(n),P(o)),H(e,f),_[t].d(f)}}}function At(l,e,n){let{value:t=null}=e,{subtitle:i=null}=e,{label:o=void 0}=e,{show_label:r=!0}=e,{autoplay:s}=e,{show_share_button:_=!0}=e,{show_download_button:b=!0}=e,{loop:f}=e,{i18n:u}=e,{upload:d}=e,{display_icon_button_wrapper_top_corner:c=!1}=e,v=null,k=null;const V=Ne();Ge(async()=>{t!==v&&i!==k&&k!==null&&(v=t,n(0,t=null),await Je(),n(0,t=v)),v=t,k=i});function j(m){G.call(this,l,m)}function O(m){G.call(this,l,m)}function F(m){G.call(this,l,m)}function W(m){G.call(this,l,m)}const N=()=>{V("load")},h=async m=>m?await xe(m.data):"";function L(m){G.call(this,l,m)}function D(m){G.call(this,l,m)}return l.$$set=m=>{"value"in m&&n(0,t=m.value),"subtitle"in m&&n(1,i=m.subtitle),"label"in m&&n(2,o=m.label),"show_label"in m&&n(3,r=m.show_label),"autoplay"in m&&n(4,s=m.autoplay),"show_share_button"in m&&n(5,_=m.show_share_button),"show_download_button"in m&&n(6,b=m.show_download_button),"loop"in m&&n(7,f=m.loop),"i18n"in m&&n(8,u=m.i18n),"upload"in m&&n(9,d=m.upload),"display_icon_button_wrapper_top_corner"in m&&n(10,c=m.display_icon_button_wrapper_top_corner)},l.$$.update=()=>{l.$$.dirty&1&&t&&V("change",t)},[t,i,o,r,s,_,b,f,u,d,c,V,j,O,F,W,N,h,L,D]}class It extends ae{constructor(e){super(),ue(this,e,At,Bt,re,{value:0,subtitle:1,label:2,show_label:3,autoplay:4,show_share_button:5,show_download_button:6,loop:7,i18n:8,upload:9,display_icon_button_wrapper_top_corner:10})}get value(){return this.$$.ctx[0]}set value(e){this.$$set({value:e}),y()}get subtitle(){return this.$$.ctx[1]}set subtitle(e){this.$$set({subtitle:e}),y()}get label(){return this.$$.ctx[2]}set label(e){this.$$set({label:e}),y()}get show_label(){return this.$$.ctx[3]}set show_label(e){this.$$set({show_label:e}),y()}get autoplay(){return this.$$.ctx[4]}set autoplay(e){this.$$set({autoplay:e}),y()}get show_share_button(){return this.$$.ctx[5]}set show_share_button(e){this.$$set({show_share_button:e}),y()}get show_download_button(){return this.$$.ctx[6]}set show_download_button(e){this.$$set({show_download_button:e}),y()}get loop(){return this.$$.ctx[7]}set loop(e){this.$$set({loop:e}),y()}get i18n(){return this.$$.ctx[8]}set i18n(e){this.$$set({i18n:e}),y()}get upload(){return this.$$.ctx[9]}set upload(e){this.$$set({upload:e}),y()}get display_icon_button_wrapper_top_corner(){return this.$$.ctx[10]}set display_icon_button_wrapper_top_corner(e){this.$$set({display_icon_button_wrapper_top_corner:e}),y()}}const $t=Object.freeze(Object.defineProperty({__proto__:null,default:It},Symbol.toStringTag,{value:"Module"}));export{Rt as P,It as V,$t as a};
//# sourceMappingURL=VideoPreview-B7gMOGKp.js.map
